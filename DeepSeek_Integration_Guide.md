# DeepSeek API 集成指南

## 概述

我已经成功将 DeepSeek API 集成到您的健身教练应用中，为 AI 教练功能提供了更智能、更个性化的对话体验。

## 重要说明

✅ **已完成配置**：您的 DeepSeek API key (`sk-0834a814d7dd43049b8f2757f3f3554f`) 已经成功集成到应用中！

- AI 增强功能已自动启用
- 应用会优先使用您配置的 API key
- 如果没有自定义配置，会使用您提供的默认 API key

## 功能特性

### 1. AI 增强对话
- 基于用户的健身目标和进度提供个性化建议
- 支持不同教练性格（严格型、温和型、幽默型）
- 维护对话历史，提供连贯的交流体验

### 2. 智能上下文理解
- 自动获取用户信息（昵称、健身目标、当前进度）
- 结合今日打卡情况提供针对性指导
- 根据契约完成天数调整建议内容

### 3. 配置管理
- 支持启用/禁用 DeepSeek AI 功能
- API key 安全存储（本地加密）
- 配置状态持久化

## 使用步骤

### 1. ✅ API Key 已配置
您的 DeepSeek API key 已经成功集成到应用中：
- API Key: `sk-0834a814d7dd43049b8f2757f3f3554f`
- 状态: 已启用
- 自动初始化: 是

### 2. 立即开始使用
1. 打开健身教练应用：http://localhost:5174/
2. 登录您的账号
3. 进入 AI 教练页面
4. 开始与 AI 教练对话！

### 3. 功能体验
- ✅ AI 教练会显示"AI增强"标识
- ✅ 发送消息时使用 DeepSeek AI 生成智能回复
- ✅ 个性化建议基于您的健身目标和进度
- ✅ 自动错误处理和降级机制

### 4. 可选：自定义配置
如果需要更改设置：
1. 点击 AI 教练页面的"管理设置"按钮
2. 修改 API key 或其他配置
3. 保存更改

## 技术实现

### 文件结构
```
src/
├── lib/
│   └── deepseek-api.ts          # DeepSeek API 客户端
├── pages/
│   ├── AICoach.tsx              # AI 教练主页面（已更新）
│   └── AICoachSettings.tsx      # AI 教练设置页面（新增）
└── store/
    └── index.ts                 # 状态管理（已更新）
```

### 主要组件

#### DeepSeek API 客户端 (`deepseek-api.ts`)
- `DeepSeekAPI` 类：处理 API 调用
- `FitnessCoachAI` 类：封装健身教练逻辑
- 支持流式和非流式对话

#### AI 教练设置页面 (`AICoachSettings.tsx`)
- API key 输入和管理
- 功能开关控制
- 配置验证和保存

#### 状态管理更新
- 新增 `deepSeekApiKey` 和 `deepSeekEnabled` 状态
- 新增 `setDeepSeekConfig` 方法
- 配置信息持久化存储

## 安全考虑

1. **API Key 保护**
   - API key 存储在本地浏览器存储中
   - 不会发送到除 DeepSeek 外的任何服务器
   - 支持显示/隐藏 API key

2. **错误处理**
   - API 调用失败时自动降级
   - 用户友好的错误提示
   - 不会暴露敏感信息

3. **数据隐私**
   - 对话历史仅在本地存储
   - 发送给 DeepSeek 的信息仅包含必要的上下文

## 故障排除

### 常见问题

1. **API key 无效**
   - 确认 API key 格式正确（以 `sk-` 开头）
   - 检查 API key 是否有效且未过期
   - 确认账户余额充足

2. **网络连接问题**
   - 检查网络连接
   - 确认防火墙设置
   - 尝试刷新页面

3. **功能未启用**
   - 确认已在设置中启用 DeepSeek AI
   - 检查 API key 是否正确配置
   - 重新保存配置

### 调试信息
- 打开浏览器开发者工具查看控制台日志
- 检查网络请求是否成功
- 查看本地存储中的配置信息

## 后续优化建议

1. **功能增强**
   - 添加对话历史管理
   - 支持更多 AI 模型选择
   - 添加对话导出功能

2. **性能优化**
   - 实现请求缓存
   - 添加请求重试机制
   - 优化 API 调用频率

3. **用户体验**
   - 添加打字效果
   - 支持语音输入/输出
   - 添加快捷回复选项

## 联系支持

如果您在使用过程中遇到任何问题，请：
1. 检查本文档的故障排除部分
2. 查看浏览器控制台的错误信息
3. 确认 DeepSeek API 服务状态

---

*最后更新：2024年1月*