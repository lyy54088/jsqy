<!DOCTYPE html>
<html>
<head>
    <title>æ£€æŸ¥localStorageæ•°æ®</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .log { margin: 10px 0; padding: 10px; background: #f5f5f5; border-radius: 5px; }
        .error { background: #ffebee; color: #c62828; }
        .success { background: #e8f5e9; color: #2e7d32; }
        .warning { background: #fff3e0; color: #ef6c00; }
    </style>
</head>
<body>
    <h1>æ£€æŸ¥localStorageä¸­çš„æ‰“å¡å†å²æ•°æ®</h1>
    <div id="output"></div>
    
    <script>
        function log(message, type = 'info') {
            const output = document.getElementById('output');
            const div = document.createElement('div');
            div.className = `log ${type}`;
            div.textContent = message;
            output.appendChild(div);
            console.log(message);
        }
        
        try {
            log('å¼€å§‹æ£€æŸ¥localStorageæ•°æ®...', 'info');
            
            const storageData = localStorage.getItem('fitness-contract-storage');
            if (storageData) {
                const data = JSON.parse(storageData);
                log('æ‰¾åˆ°localStorageæ•°æ®', 'success');
                
                // æ£€æŸ¥ä»Šæ—¥æ‰“å¡è®°å½•
                if (data.state && data.state.todayCheckIns) {
                    log(`ä»Šæ—¥æ‰“å¡è®°å½•æ•°é‡: ${data.state.todayCheckIns.length}`, 'info');
                    data.state.todayCheckIns.forEach((checkIn, index) => {
                        log(`ä»Šæ—¥æ‰“å¡ ${index + 1}: ${checkIn.type} - ${checkIn.aiResult?.description || 'æ— AIç»“æœ'}`, 'info');
                        if (checkIn.aiResult && checkIn.aiResult.description.includes('å¾®ä¿¡')) {
                            log(`âš ï¸ å‘ç°å¾®ä¿¡ç›¸å…³çš„ä»Šæ—¥æ‰“å¡è®°å½•!`, 'warning');
                            log(`è¯¦æƒ…: ${JSON.stringify(checkIn.aiResult)}`, 'warning');
                        }
                    });
                }
                
                // æ£€æŸ¥å†å²æ‰“å¡è®°å½•
                if (data.state && data.state.checkInHistory) {
                    log(`å†å²æ‰“å¡è®°å½•æ•°é‡: ${data.state.checkInHistory.length}`, 'info');
                    let wechatCount = 0;
                    data.state.checkInHistory.forEach((checkIn, index) => {
                        if (checkIn.aiResult && checkIn.aiResult.description.includes('å¾®ä¿¡')) {
                            wechatCount++;
                            log(`ğŸš¨ å‘ç°å¾®ä¿¡ç›¸å…³å†å²è®°å½• ${index + 1}:`, 'error');
                            log(`ç±»å‹: ${checkIn.type}`, 'error');
                            log(`æ—¶é—´: ${checkIn.timestamp}`, 'error');
                            log(`AIç»“æœ: ${checkIn.aiResult.description}`, 'error');
                            log(`å›¾ç‰‡URLå‰50å­—ç¬¦: ${checkIn.imageUrl ? checkIn.imageUrl.substring(0, 50) + '...' : 'null'}`, 'error');
                            log('---', 'error');
                        }
                    });
                    
                    if (wechatCount > 0) {
                        log(`æ€»å…±å‘ç° ${wechatCount} æ¡å¾®ä¿¡ç›¸å…³çš„å†å²è®°å½•`, 'error');
                    } else {
                        log('æ²¡æœ‰å‘ç°å¾®ä¿¡ç›¸å…³çš„å†å²è®°å½•', 'success');
                    }
                }
            } else {
                log('æ²¡æœ‰æ‰¾åˆ°localStorageæ•°æ®', 'warning');
            }
        } catch (error) {
            log(`è§£ælocalStorageæ•°æ®å¤±è´¥: ${error.message}`, 'error');
        }
    </script>
</body>
</html>