<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboardè°ƒè¯•å·¥å…·</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .button {
            background: #007AFF;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            margin: 5px;
            font-size: 14px;
        }
        .button:hover {
            background: #0056CC;
        }
        .status {
            padding: 10px;
            border-radius: 6px;
            margin: 10px 0;
        }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
        .warning { background: #fff3cd; color: #856404; }
        .info { background: #d1ecf1; color: #0c5460; }
        pre {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 6px;
            overflow-x: auto;
            font-size: 12px;
        }
    </style>
</head>
<body>
    <h1>ğŸ”§ Dashboard è°ƒè¯•å·¥å…·</h1>
    
    <div class="card">
        <h2>ğŸ“Š åº”ç”¨çŠ¶æ€æ£€æŸ¥</h2>
        <button class="button" onclick="checkAppState()">æ£€æŸ¥åº”ç”¨çŠ¶æ€</button>
        <button class="button" onclick="checkLocalStorage()">æ£€æŸ¥ LocalStorage</button>
        <button class="button" onclick="testNavigation()">æµ‹è¯•è·¯ç”±è·³è½¬</button>
        <div id="status"></div>
    </div>
    
    <div class="card">
        <h2>ğŸš€ å¿«é€Ÿæ“ä½œ</h2>
        <button class="button" onclick="quickLogin()">å¿«é€Ÿç™»å½•</button>
        <button class="button" onclick="clearAllData()">æ¸…ç†æ‰€æœ‰æ•°æ®</button>
        <button class="button" onclick="openDashboard()">æ‰“å¼€ Dashboard</button>
        <button class="button" onclick="openAuth()">æ‰“å¼€ç™»å½•é¡µ</button>
    </div>
    
    <div class="card">
        <h2>ğŸ“ è°ƒè¯•æ—¥å¿—</h2>
        <button class="button" onclick="clearLogs()">æ¸…ç†æ—¥å¿—</button>
        <pre id="logs"></pre>
    </div>

    <script>
        let logs = [];
        
        function log(message, type = 'info') {
            const timestamp = new Date().toLocaleTimeString();
            logs.push(`[${timestamp}] ${message}`);
            updateLogs();
            console.log(message);
        }
        
        function updateLogs() {
            document.getElementById('logs').textContent = logs.slice(-20).join('\n');
        }
        
        function clearLogs() {
            logs = [];
            updateLogs();
        }
        
        function showStatus(message, type = 'info') {
            const statusDiv = document.getElementById('status');
            statusDiv.innerHTML = `<div class="status ${type}">${message}</div>`;
        }
        
        function checkAppState() {
            log('å¼€å§‹æ£€æŸ¥åº”ç”¨çŠ¶æ€...');
            
            // æ£€æŸ¥åº”ç”¨æ˜¯å¦åœ¨è¿è¡Œ
            fetch('http://localhost:5173')
                .then(response => {
                    if (response.ok) {
                        log('âœ… åº”ç”¨æœåŠ¡å™¨è¿è¡Œæ­£å¸¸');
                        showStatus('åº”ç”¨æœåŠ¡å™¨è¿è¡Œæ­£å¸¸', 'success');
                        
                        // æ‰“å¼€åº”ç”¨å¹¶æ£€æŸ¥çŠ¶æ€
                        const appWindow = window.open('http://localhost:5173', '_blank');
                        
                        setTimeout(() => {
                            try {
                                // å°è¯•è®¿é—®åº”ç”¨çš„çŠ¶æ€
                                if (appWindow && !appWindow.closed) {
                                    log('âœ… åº”ç”¨é¡µé¢å·²æ‰“å¼€');
                                } else {
                                    log('âŒ æ— æ³•æ‰“å¼€åº”ç”¨é¡µé¢');
                                }
                            } catch (error) {
                                log(`âŒ æ£€æŸ¥åº”ç”¨çŠ¶æ€æ—¶å‡ºé”™: ${error.message}`);
                            }
                        }, 2000);
                    } else {
                        log('âŒ åº”ç”¨æœåŠ¡å™¨å“åº”å¼‚å¸¸');
                        showStatus('åº”ç”¨æœåŠ¡å™¨å“åº”å¼‚å¸¸', 'error');
                    }
                })
                .catch(error => {
                    log(`âŒ æ— æ³•è¿æ¥åˆ°åº”ç”¨æœåŠ¡å™¨: ${error.message}`);
                    showStatus('æ— æ³•è¿æ¥åˆ°åº”ç”¨æœåŠ¡å™¨ï¼Œè¯·ç¡®ä¿å¼€å‘æœåŠ¡å™¨æ­£åœ¨è¿è¡Œ', 'error');
                });
        }
        
        function checkLocalStorage() {
            log('æ£€æŸ¥ LocalStorage æ•°æ®...');
            
            try {
                const storageData = localStorage.getItem('fitness-contract-storage');
                if (storageData) {
                    const data = JSON.parse(storageData);
                    const state = data.state;
                    
                    log(`ç”¨æˆ·æ•°æ®: ${state.user ? 'å·²ç™»å½•' : 'æœªç™»å½•'}`);
                    log(`å¥‘çº¦æ•°æ®: ${state.currentContract ? 'å­˜åœ¨' : 'ä¸å­˜åœ¨'}`);
                    log(`AIæ•™ç»ƒ: ${state.aiCoach ? 'å·²è®¾ç½®' : 'æœªè®¾ç½®'}`);
                    
                    if (state.user) {
                        log(`ç”¨æˆ·ä¿¡æ¯: ${state.user.nickname} (${state.user.phone})`);
                    }
                    
                    if (state.currentContract) {
                        log(`å¥‘çº¦çŠ¶æ€: ${state.currentContract.paymentStatus}`);
                        log(`å¥‘çº¦ç±»å‹: ${state.currentContract.type}`);
                    }
                    
                    showStatus('LocalStorage æ•°æ®æ£€æŸ¥å®Œæˆï¼Œè¯¦è§æ—¥å¿—', 'success');
                } else {
                    log('âŒ æ²¡æœ‰æ‰¾åˆ° LocalStorage æ•°æ®');
                    showStatus('æ²¡æœ‰æ‰¾åˆ°åº”ç”¨æ•°æ®ï¼Œç”¨æˆ·å¯èƒ½æœªç™»å½•', 'warning');
                }
            } catch (error) {
                log(`âŒ è§£æ LocalStorage æ•°æ®æ—¶å‡ºé”™: ${error.message}`);
                showStatus('LocalStorage æ•°æ®æŸå', 'error');
            }
        }
        
        function testNavigation() {
            log('æµ‹è¯•è·¯ç”±è·³è½¬...');
            
            const routes = [
                '/auth',
                '/dashboard', 
                '/contract/create',
                '/checkin',
                '/history',
                '/profile',
                '/community'
            ];
            
            routes.forEach(route => {
                const url = `http://localhost:5173${route}`;
                log(`æµ‹è¯•è·¯ç”±: ${route}`);
                
                fetch(url)
                    .then(response => {
                        if (response.ok) {
                            log(`âœ… è·¯ç”± ${route} å¯è®¿é—®`);
                        } else {
                            log(`âŒ è·¯ç”± ${route} å“åº”å¼‚å¸¸`);
                        }
                    })
                    .catch(error => {
                        log(`âŒ è·¯ç”± ${route} æµ‹è¯•å¤±è´¥: ${error.message}`);
                    });
            });
            
            showStatus('è·¯ç”±æµ‹è¯•è¿›è¡Œä¸­ï¼Œè¯¦è§æ—¥å¿—', 'info');
        }
        
        function quickLogin() {
            log('æ‰§è¡Œå¿«é€Ÿç™»å½•...');
            
            const testUser = {
                id: 'test-user-' + Date.now(),
                phone: '13800138000',
                nickname: 'æµ‹è¯•ç”¨æˆ·',
                age: 25,
                height: 170,
                weight: 65,
                fitnessGoal: 'lose_weight',
                createdAt: new Date()
            };
            
            const appData = {
                state: {
                    user: testUser,
                    isLoggedIn: true,
                    aiCoach: null,
                    currentContract: null,
                    contractHistory: [],
                    todayCheckIns: [],
                    checkInHistory: [],
                currentChatSession: null,
                chatHistory: [],
                    loading: false,
                    error: null
                },
                version: 0
            };
            
            localStorage.setItem('fitness-contract-storage', JSON.stringify(appData));
            log('âœ… å¿«é€Ÿç™»å½•å®Œæˆ');
            showStatus('å¿«é€Ÿç™»å½•å®Œæˆï¼Œè¯·åˆ·æ–°åº”ç”¨é¡µé¢', 'success');
        }
        
        function clearAllData() {
            log('æ¸…ç†æ‰€æœ‰æ•°æ®...');
            localStorage.removeItem('fitness-contract-storage');
            log('âœ… æ‰€æœ‰æ•°æ®å·²æ¸…ç†');
            showStatus('æ‰€æœ‰æ•°æ®å·²æ¸…ç†ï¼Œè¯·åˆ·æ–°åº”ç”¨é¡µé¢', 'success');
        }
        
        function openDashboard() {
            log('æ‰“å¼€ Dashboard...');
            window.open('http://localhost:5173/dashboard', '_blank');
        }
        
        function openAuth() {
            log('æ‰“å¼€ç™»å½•é¡µ...');
            window.open('http://localhost:5173/auth', '_blank');
        }
        
        // é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨æ£€æŸ¥çŠ¶æ€
        window.onload = function() {
            log('è°ƒè¯•å·¥å…·å·²åŠ è½½');
            checkLocalStorage();
        };
    </script>
</body>
</html>